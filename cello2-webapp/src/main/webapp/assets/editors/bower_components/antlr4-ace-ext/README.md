[![Build Status](https://travis-ci.org/maiermic/antlr4-ace-ext.svg)](https://travis-ci.org/maiermic/antlr4-ace-ext)

Tokenizer for [ACE editor][ACE editor] to do syntax highlighting using an [ANTLR4][ANTLR4] lexer.

## How to install

Use bower to install:

```sh
bower install --save antlr4-ace-ext
```

You can install ACE editor from bower, too:

```sh
bower install --save ace-builds
```


## How to use

After `ace` is loaded

```html
<script src="bower_components/ace-builds/src-noconflict/ace.js"></script>
```

add scripts: 

```html
<script src="bower_components/antlr4-ace-ext/src/token-type-map.js"></script>
<script src="bower_components/antlr4-ace-ext/src/tokenizer.js"></script>
```

They register themselves as ACE modules `ace/ext/antlr4/tokenizer` and `ace/ext/antlr4/token-type-map`. You can require them in your mode:

```js
ace.define(
  'ace/mode/my-mode',
  [
    "require",
    "exports",
    "module",
    "ace/ext/antlr4/tokenizer",
    "ace/ext/antlr4/token-type-map"
  ],
  function(require, exports, module) {
    var createTokenTypeMap = require('ace/ext/antlr4/token-type-map').createTokenTypeMap;
    var Antlr4Tokenizer = require('ace/ext/antlr4/tokenizer').Antlr4Tokenizer;
    // ...
  }
}
```

Override the `getTokenizer` method of your mode class to use you custom tokenizer:

```js
MyMode.prototype.getTokenizer = function() {
  if (!this.$tokenizer) {
    this.$tokenizer = new Antlr4Tokenizer(MyLanguageLexer, antlrTokenNameToAceTokenType);
  }
  return this.$tokenizer;
};
```

The `Antlr4Tokenizer` constructor takes an lexer class generated by ANTLR4 and a mapping of ANTLR4 token names to ACE token types. The mapping describes which ANTLR4 token name refers to which ACE token type (see [common ACE tokens](https://github.com/ajaxorg/ace/wiki/Creating-or-Extending-an-Edit-Mode#common-tokens)).

```js
{
  "'+'": 'keyword.operator',
  "'-'": 'keyword.operator',
  "'return'": 'keyword.control',
  "ID": 'identifier',
  "INT": 'constant.numeric'
}
```

You can use the helper function `createTokenTypeMap` to create a token type map for your `Antlr4Tokenizer`:

```js
var antlrTokenNameToAceTokenType = createTokenTypeMap({
  literals: {
    'keyword.operator': ['+', '-'],
    'keyword.control': 'return'
  },
  symbols: {
    'identifier': 'ID',
    'constant.numeric': 'INT'
  }
});
```

Thereby, you do not have to quote literal token names and you can map multiple token names as array to the same ACE token type.

## Example

[See][example] the browser example of the Cymbol language ([Demo][example-demo]).

> ### 6.4 Parsing Cymbol
  To demonstrate how to parse a programming language with syntax derived
  from C, weâ€™re going to build a grammar for a language I conjured up called
  Cymbol. Cymbol is a simple non-object-oriented programming language that
  looks like C without  struct s.
>
> from [The Definitive ANTLR 4 Reference][antlr4-book]

[example]: https://github.com/maiermic/antlr4-javascript-examples/tree/master/browser-example
[example-demo]: http://maiermic.github.io/antlr4-javascript-examples/browser-example/
[antlr4-book]: https://pragprog.com/book/tpantlr2/the-definitive-antlr-4-reference

## How to build
 
### Required

- [Node.JS](https://nodejs.org)
- [ANTLR4](http://www.antlr.org/download.html) (`antlr4` has to be available as environment variable to (re-) build grammar files)  

### Build Instructions

1. Install dependencies: `npm install` 
2. Build project: `npm run build` 
3. Run tests: `npm test` 

[ACE editor]: https://ace.c9.io
[ANTLR4]: http://www.antlr.org/